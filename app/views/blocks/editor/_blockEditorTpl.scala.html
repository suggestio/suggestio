@(af: Form[_], withBC: Option[BlockConf] = None, formDataSer: Option[String] = None)(implicit ctx: Context)

@import util.blocks._, BlocksUtil._

@defining( "ad.offer" ) { nameBase =>
@defining(  withBC.getOrElse( BlocksConf(1) )  ) { bc =>

<div class="ad-block-editor">
  @for(bf <- bc.blockFields) {

    <div class="ad-block-editor__fieldset">
      @bf.renderEditorField(
        af = af,
        bfNameBase = nameBase + bf.offerNopt.map(".offer[" + _ + "]").getOrElse("") + "." + bf.name,
        bc = bc
      )
    </div>
    <div class="clear"></div>

  }

  @* Исходный id блока. Необходим при переключении блоков. *@
  <input type="hidden" name="@{nameBase}.oldBlockId" value="@bc.id"/>

  @* Новый/текущий id блока. При переключении сюда втыкается новый id блока и происходит submit для получения новой формы. *@
  <input type="hidden" name="@nameBase.@BLOCK_ID_FN" value="@bc.id"/>

  @formDataSer.map { fds =>
    <input type="hidden" name="formData" value="@fds"/>
  }
</div>
}
}
