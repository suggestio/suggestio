@(af: Form[_])(implicit ctx: Context)

@import util.blocks._, BlocksUtil._

@defining( "ad.offer." ) { nameBase =>
@defining( af(nameBase + BK_BLOCK_ID).value ) { biFieldValue =>
@defining( BlocksConf(biFieldValue.map(_.toInt).getOrElse(1)) ) { bc =>
  <div class="preview-wrap">

    <div class="block-editor">
      <div class="block-preview" id="blockPreviewContainer">
        @if(biFieldValue.isDefined) {
          @bc.renderEditorPreview(af, nameBase)
        }
      </div>
    </div>
  </div>
  <div class="controls">
    <div class="block-editor-form">

      <div id="blockEditorForm">
        @for(bf <- bc.blockFields) {
          @bf.renderEditorField(
            formField = af(nameBase + bf.name),
            bc = bc
          )
          <div class="clear"></div>
        }

        <input type="hidden" name="@nameBase@BK_BLOCK_ID" value="@bc.id">

      </div>
    </div>
  </div>
}
}
}