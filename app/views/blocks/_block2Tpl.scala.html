@(mad: MAdT, isStandalone: Boolean)(implicit ctx: util.Context)

@import ctx._
@import util.blocks.BlocksUtil._
@import util.TplDataFormatUtil._
@import common._
@import svg._

@blockBase(isStandalone) {

  @defining( mad.colors.getOrElse(Block2.fillColorBf.name, Block2.fillColorBf.anyDefaultValue) ) { fillColor =>

    <div class="sm-block height-@mad.blockMeta.height sio-mart__single-offer sm-block-tpl2 sm-block@mad.id" data-width="300" data-height="@mad.blockMeta.height" data-mad-id="@mad.id">

      @mad.offers.headOption.map { offer =>
        @offer.discount.map { discount =>
        <div class="sale-icon" style="color: #@discount.font.color;">
          @formatPercentRaw(offer.discount.map(_.value).getOrElse(0F))<span>%</span>
        </div>
        }
      }

      <div class="sale-mask-wrap" style="background: #@fillColor; border-color: #@mad.colors.getOrElse(Block2.borderColorBf.name, Block2.borderColorBf.anyDefaultValue)">

        @_mask2(
          cssClass = "mask",
          fillColor = fillColor
        )

        <!--<div class="mask"></div>-->
        <div class="bg">
          <img style="height: auto;" src="@ctx.myAudienceUrl@mad.imgs.get(Block2.BG_IMG_FN).map { img =>@routes.Img.getImg(img.filename) }.getOrElse(routes.Assets.at("images/market/blocks/tpl2-bg.jpg"))"/>
        </div>
      </div>

      <div class="info" style="background: #@fillColor; border-color: #@mad.colors.getOrElse(Block2.borderColorBf.name, Block2.borderColorBf.anyDefaultValue)">
        @mad.offers.headOption.map { offer =>
          @offer.text1.map { title =>
            <div class="js-mvbl mvbl-title" data-connected-input="ad.offer.title" style="@_coordsStyleTpl(title, left = 22, top = 219)">
              <h5 class="title">@Html(title.value)</h5>
            </div>
            @_blockStyleTpl( mad.id, title, Block2.titleBf, "title", left = 22, top = 219 )
          }

          @offer.text2.map { descr =>
            <div class="js-mvbl mvbl-descr" data-connected-input="ad.offer.descr" style="@_coordsStyleTpl(descr, left = 22, top = 249)">
            <div class="descr">
              <p>@Html(descr.value)</p>
            </div>
            </div>
            @_blockStyleTpl( mad.id, descr, Block2.descrBf, "descr", left = 22, top = 249 )
          }

        }
      </div>

    </div>

  }
}
