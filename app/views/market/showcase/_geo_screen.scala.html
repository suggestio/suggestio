@(args: ScRenderArgs)(implicit ctx: Context)
@import util.TplDataFormatUtil._

<div class="sm-geo-screen" id="smGeoScreen" @if(args.jsStateOpt.exists(_.isNavScrOpened)) {style="display: block; height: 83%;"} >

  <div class="sm-geo-screen_header">

    @* В синхронном режиме рендерим кнопку ссылкой. *@
    @args.jsStateOpt.map { jsState =>
      <a href="@args.syncUrl( jsState.toggleNavScreen )">
    }
    <div class="sm-button sm-producer-header_btn __left-aligned abs" id="smGeoScreenCloseButton">
      @svg._backArrowLeft( args.fgColor )
    </div>
    @if(args.jsStateOpt) {
      </a>
    }

  </div>

  <div class="sm-geo-screen_current-location" id="smGeoLocationButton" style="@stuff._bgcolor( args.bgColor, true );">
    <div class="sm-geo-screen_current-location-inner">
      <div class="sm-geo-screen_current-location-icon" id="smGeoLocationButtonIcon">@svg._geoRefresh(args.fgColor)</div>
      <div class="sm-geo-screen_current-location-spinner" id="smGeoLocationButtonSpinner">@svg._spinnerTpl(args.fgColor)</div>
      <span id="smGeoLocationLabel" style="color: #@args.fgColor;">
        @args.adnNodeCurrentGeo.fold("Определить местоположение")(_.meta.name)
      </span>
    </div>
  </div>

  @stuff.scrollableContainerTpl( "sm-geo-nodes", "smGeoNodes", style = Some(stuff._bgcolor( args.bgColor, true ).toString + "height: 83%;") ) {
    @args.inlineNodesList
  }

  <style type="text/css">
    @defining( colorRgb2Hsl(colorHex2rgb(args.bgColor)) ) { hslColor =>
    .shops-list_row {
      color:#@args.fgColor;
    }

    .geo-nodes-list_rows {
      background: #@args.bgColor;
    }

    .geo-nodes-list_layer,
    .geo-nodes-list_row {
      color: #@args.fgColor;
    }

    .geo-nodes-list_layer {
      border-color: rgba( @colorHex2rgb(args.fgColor).mkString(","), 0.5 );
    }

    .geo-nodes-list_rows {
      -webkit-box-shadow: inset 0px 5px 5px hsl( @{hslColor(0)}, @{hslColor(1)}%, @{hslColor(2)-6}% );
      box-shadow: inset 0px 5px 5px hsl( @{hslColor(0)}, @{hslColor(1)}%, @{hslColor(2)-6}% );
    }

    .geo-nodes-list_row.__even {
      background-color: hsl( @{hslColor(0)}, @{hslColor(1)}%, @{hslColor(2)-3}%);
    }

    .geo-nodes-list_layer-icon path,
    .geo-nodes-list_layer-icon-right path{
      fill:     #@args.fgColor;
    }

    .geo-nodes-list_row,
    .sm-geo-screen_current-location-inner{
      border-color: rgba( @colorHex2rgb(args.fgColor).mkString(","), 0.5 );
    }
    }

    .geo-nodes-links {
      color: rgba( @colorHex2rgb(args.fgColor).mkString(","), 0.5 );
    }

  </style>

</div>
