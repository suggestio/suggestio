@(mmart: MAdnNode, mshop:MAdnNode, mads:Seq[MAdT])(implicit ctx:util.Context)

@* Страница отображения магазина для арендатора ТЦ (т.е. для владельца этого магазина). *@
@import market.lk._

@import routes.MarketShopLk._
@import ctx._
@import AdShowLevels._

@lkBase(mshop.meta.name) {

  @helper.javascriptRouter("jsRoutes")(
    routes.javascript.MarketAd.updateShowLevelSubmit
  )

  <div class="title-wrap">
    <div class="center">
      <a class="back-but" href="@routes.MarketLk.lkList">&nbsp;</a>
      <div class="title-inner">
        ЛИЧНЫЙ КАБИНЕТ АРЕНДАТОРА
      </div>
    </div>
  </div>

  <div class="body">

    <input id="maxShopAds" type="hidden" value="@mshop.adn.showLevelsInfo.maxOutAtLevel(LVL_MEMBER)" />

    <div class="shop-info">

      <div class="name-wrap">
        <span class="name">@mshop.meta.name</span>
        <a class="edit" href="@editShopForm(mshop.id.get)">Редактировать</a>
      </div>
      <div class="border-line"></div>

      <table class="block">
        <tr>
          <td class="right" style="border-left: none; padding-left: 0;">
            <div class="shop-descr">
              @mshop.meta.description
            </div>
          </td>
        </tr>
      </table>

      @* Отобразить основное описание магазина с кнопкой редактирования. *@
      @shop._shopShowTpl(
        mshop = mshop,
        editCall = routes.MarketShopLk.editShopForm(mshop.id.get)
      )

    </div>


    @defining(mshop.adn.canOutAtLevel(LVL_MEMBERS_CATALOG)) { hc =>
    @defining(mshop.adn.canOutAtLevel(LVL_MEMBER)) { hm =>
    @defining(mshop.adn.canOutAtLevel(LVL_START_PAGE)) { hsp =>

      @market.lk.ad._adsEditableListTpl(
        mads = mads,
        producer = mshop,
        addCall = routes.MarketAd.createShopAd(mshop.id.get),
        editCall = routes.MarketAd.editShopAd(_),
        fallbackLogo = mmart.logoImgOpt
      ) { mad =>
        @* Галочки для управления отображением рекламной карточки магазина. *@
        @defining(mad.allWantShowLevels) { sls =>
          <div class="controls">
            <label class="common-catalog @if(!hc){inactive}">
              <input class="one-checkbox" type="checkbox" data-level="@LVL_MEMBERS_CATALOG" data-adid="@mad.id" data-name="common-catalog" @if(!hc){disabled="disabled"} @if(sls contains LVL_MEMBERS_CATALOG) {data-checked="checked"}/>Выводить в общем каталоге
            </label>
            <label class="shop-catalog @if(!hm){inactive}">
              <input type="checkbox" data-level="@LVL_MEMBER" data-adid="@mad.id" @if(!hm){disabled="disabled"} @if(sls contains LVL_MEMBER) {data-checked="checked"}/>Выводить в моём магазине
            </label>
            <label class="firstPage-catalog @if(!hsp){inactive}">
              <input class="one-checkbox" data-name="firstPage-catalog" type="checkbox" data-level="@LVL_START_PAGE" data-adid="@mad.id" @if(!hsp){disabled="disabled"} @if(sls contains LVL_START_PAGE) {data-checked="checked"}/>Размещение на первом экране
            </label>
          </div>
        }
      }

    }
    }
    }

  </div>

}
