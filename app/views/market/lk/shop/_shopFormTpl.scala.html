@(call:Call, sf: Form[_], btnText:String, isLimited: Boolean, shopId: String)(implicit ctx: util.Context)

@* Форма для добавления/редактирования магазинов в MarketLk.
   - Если isLimited, то некоторые поля будут заблокированы. *@
@import helper._
@import ctx._


@import util.FormHelpers._


@form(call) {

  <div class="fields">
    @*  *@
    <table cellpadding="0" cellspacing="0" class="input-wrap big">
      @inputText(
        sf("meta.name"),
        '_label -> "Название магазина:"
      )
    </table>

    @* Логотип магазина. *@
    <table cellpadding="0" cellspacing="0" class="input-wrap big img-with-preview">
      <tr>
        <td class="left">
          <label>Логотип:</label>
        </td>
        <td class="right">

          <div class="select-file-wrap" id="logoImgInput">
            @defining(sf("logoImgId").value) { logoImgIdOpt =>
            <div class="preview">
              <img class="image-preview" src="@logoImgIdOpt.filter(!_.isEmpty).map { imgId =>@routes.Img.getImg(imgId) }.getOrElse {@routes.Assets.at("images/market/lk/empty-image.gif")}" width="59"/>
            </div>
            <div class="selectbox">
              <div class="select-file">
                @stuff._fileUploadTpl(routes.MarketShopLk.handleShopTempLogo(shopId), relatedFieldId="logoImgInput")
                <input class="image-key" type="hidden" name="logoImgId" value="@logoImgIdOpt"/>
                <div class="bg">Выбрать файл для загрузки</div>
              </div>
              <div class="descr">
                Файл должен быть на прозрачном
                фоне и иметь формат .png
              </div>
            </div>
            }
          </div>

          <a href="#" class="close">&nbsp;</a>
        </td>
      </tr>
    </table>


    @* Поля этажа/секции доступны только владельцу ТЦ, т.е. если !isLimited. Задаём атрибут через хвост-список. *@
    @defining(if(isLimited) List('disabled -> "") else Nil) { attrsRest =>


      <table cellpadding="0" cellspacing="0" class="input-wrap big textarea">
        @textarea(
          sf("shop.meta.description"),
          '_label -> "Описание магазина:"
        )
      </table>

      <table cellpadding="0" cellspacing="0" class="input-wrap big disabled">
        @inputText(
          sf("email"),
          '_label -> "E-mail:" ::
          attrsRest : _*
        )
      </table>

      @* Номер этажа в ТЦ. *@
      <table cellpadding="0" cellspacing="0" class="input-wrap small @if(isLimited) {disabled}">
        @inputText(
          sf("shop.meta.floor"),
          'placeholder -> 1 ::
          '_label -> "Этаж:" ::
          attrsRest : _*
        )
      </table>

      @* Номер секции в ТЦ. *@
      <table cellpadding="0" cellspacing="0" class="input-wrap small @if(isLimited) {disabled}">
        @inputText(
          sf("shop.meta.section"),
          'placeholder -> 101 ::
          '_label -> "Номер секции:" ::
          attrsRest : _*
        )
      </table>

    }

  </div>

  <div class="border-line"></div>
  <div class="submit-wrap">
    <input class="blue-but-small" type="submit" value="@btnText" style="float: right;"/>
  </div>


}
