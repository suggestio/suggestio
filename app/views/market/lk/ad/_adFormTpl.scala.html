@(af: Form[_], call: Call, btnText: String, dfltIsProduct: Boolean = true)(implicit ctx: util.Context)

@* Рендер формы редактирования произвольной рекламы.
 * dfltIsProduct обозначает дефолтовый режим работы формы. true - с ценами, false - реклама со скидками. *@
@import ctx._
@import helper._
@import controllers.MarketAd.FormModes._

@form(call, 'id -> "promoOfferForm") {

  @af.globalError


  <div class="block">
    <div class="border-line"></div>
    <div class="hat">
      <span class="title">Брендированая шапка</span>
      <a class="toggle open" href="#" data-content="brand-hat">Свернуть</a>
    </div>
    <div class="border-line"></div>
    <div class="slide-content" id="brand-hat">
      <div class="subhat">
        <span class="title">Редактирование логотипа</span>
        <a class="toggle open" href="#" data-content="brand-hat-logo">Свернуть</a>
      </div>
      <div class="border-line"></div>

      <div class="slide-content" id="brand-hat-logo">
        <table cellpadding="0" cellspacing="0" class="input-wrap big img-with-preview">
          <tr>
            <td class="left">
              <label>Логотип:</label>
            </td>
            <td class="right">
              <div class="select-file-wrap">
                <div class="preview">
                  <img src="" width="59" height="59"/>
                </div>
                <div class="selectbox">
                  <div class="select-file">
                    <input type="file" value="Выбрать файл для загрузки" />
                    <div class="bg">Выбрать файл для загрузки</div>
                  </div>
                  <div class="descr">
                    Файл должен быть на прозрачном
                    фоне и иметь формат .png
                  </div>
                </div>
                <a href="#" class="close">&nbsp;</a>
              </div>
            </td>
          </tr>
        </table>
        <div class="border-line"></div>
      </div>

      <table cellpadding="0" cellspacing="0" class="color-list input-wrap big">
        <tr>
          <td class="left">
            <label>Цвет плашки:</label>
          </td>

          <td class="right">
            <div class="item">
              <input type="checkbox" data-name="panelColor"/>
              <div class="color" style="background: black;">&nbsp;</div>
            </div>
            <div class="item">
              <input type="checkbox" data-name="panelColor"/>
              <div class="color" style="background: white;">&nbsp;</div>
            </div>
            <div class="item">
              <input type="checkbox" data-name="panelColor"/>
              <div class="color" style="background: gray;">&nbsp;</div>
            </div>
            <div class="item">
              <input type="checkbox" data-name="panelColor"/>
              <div class="color custom">&nbsp;
                <input type="hidden" value="" />
              </div>
            </div>
          </td>
        </tr>
      </table>

    </div>
  </div>

  <div class="block">
    <div class="border-line"></div>
    <div class="hat">
      <span class="title">Рекламная фотография</span>
      <a class="toggle open" href="#" data-content="ad-photo">Свернуть</a>
    </div>
    <div class="border-line"></div>
    <div class="slide-content" id="ad-photo">
      <table cellpadding="0" cellspacing="0" class="input-wrap big img-with-preview">
        <tr>
          <td class="left">
            <label>Фотография товара:</label>
          </td>
          <td class="right">
            <div class="select-file-wrap">
              <div class="preview">
                <img src="" width="59" height="59"/>
              </div>
              <div class="selectbox">
                <div class="select-file">
                  <input type="file" value="Выбрать файл для загрузки" data-action="#" />
                  <div class="bg">Выбрать файл для загрузки</div>
                </div>
                <div class="descr">
                  Файл должен быть на прозрачном
                  фоне и иметь формат .png
                </div>
              </div>
              <a href="#" class="close">&nbsp;</a>
            </div>
          </td>
        </tr>
      </table>
    </div>
  </div>


  <div class="block">
    <div class="border-line"></div>
    <div class="hat">
      <span class="title">Шаблоны</span>
      <a class="toggle open" href="#" data-content="templates">Свернуть</a>
    </div>
    <div class="border-line"></div>

    <div class="tabs">
      <div class="tab act">
        ТЕКСТОВОЙ
      </div>
      <div class="tab">
        СКИДОЧНЫЙ
      </div>
    </div>
    <div class="blue-line"></div>

    <div class="slide-content" id="templates">
      @* TODO Сейчас рендерится только один кусок формы. Нужно сделать js-переключение между двумя вариантами формы. *@
      @_adFormProductTpl(af, isShown = dfltIsProduct)
      @_adFormDiscountTpl(af, isShown = !dfltIsProduct)

      <table cellpadding="0" cellspacing="0" class="input-wrap">
        <tr>
          <td class="left">
            <label for="#">Положение текста:</label>
          </td>
          <td class="select-iphone">
            <span>iPhone</span>
            <div class="iphone-block act">&nbsp;</div>
            <div class="iphone-block">&nbsp;</div>
          </td>
          <td class="select-ipad">
            <span>iPad</span>
            <div class="ipad-wrap">
              <div class="ipad-block act" data-group="info">&nbsp;</div>
              <div class="ipad-block" data-group="info">&nbsp;</div>
              <span>— информация</span>
              <div class="ipad-block" data-group="contacts">&nbsp;</div>
              <div class="ipad-block act" data-group="contacts">&nbsp;</div>
              <span>— контакты</span>
            </div>
          </td>
        </tr>
      </table>

      <div class="border-line"></div>


    </div>
  </div>


  @* Input для id выбранной категории. *@
  <input data-curr-cat="cat" type="hidden" name="catId" value="@af("catId").value" />

  @* Input для цвета верхней плашки. *@
  <input type="hidden" name="panelColor" value="@af("panel.color").value.getOrElse("#000000")"/>

  @* Режим формы. Должен переключаться при переключении вкладки. *@
  <input type="hidden" name="ad.mode" value="@if(dfltIsProduct) {@PRODUCT} else {@DISCOUNT}"/>

  @* Данные по картинке загруженной. *@
  @defining(af("image_key").value) { imgIdOpt =>
    <input type="hidden" name="image_key" value="@imgIdOpt"/>
    <img class="image-preview" width="200" src="@if(imgIdOpt.isDefined) {@routes.Img.getImg(imgIdOpt.get)}" style="@if(imgIdOpt.isEmpty) {display: none}"/>
  }

  @* Положение текста на разных устройствах. Как оно задаётся - хз, пока в виде произвольной строки. *@
  @inputText(af("textAlign.phone"), '_label -> "iphone")
  @inputText(af("textAlign.tablet"), '_label -> "ipad")

  <div class="submit-wrap">
    <input class="green-but-small" type="submit" value="@btnText"/>
  </div>

}

@* Картинки - это фактически отдельная форма, и её надо в отдельный файл. *@
@stuff._fileUploadTpl(routes.Img.handleTempImg, relatedFormId="promoOfferForm")
