@(node: MAdnNode, myAds: Seq[MAdT] = Nil, supervisedNodes: Seq[MAdnNode] = Nil, fallbackLogo: Option[MImgInfo] = None)(implicit ctx: util.Context)

@* Заглавная страница узла рекламной сети в личном кабинете. *@

@import ctx._
@import controllers.adn.AdnShowTypes._
@import _node._

@market.lk.lkBase(node.meta.name, adnIdOpt = node.id) {

  @helper.javascriptRouter("jsRoutes")(
    routes.javascript.MarketAd.updateShowLevelSubmit
  )

@defining(node.adn.memberType : AdnShowType) { adnShowType =>
  @* Верхняя строка. *@
  <div class="title-wrap">
    <div class="center">

      <a class="back-but" href="@routes.MarketLk.lkList" style="visibility: hidden;">&nbsp;</a>

      <div class="title-inner">ЛИЧНЫЙ КАБИНЕТ</div>

      @* У узла-приемника есть список входных генераторов рекламы и доступ к коду установки. *@
      @if(node.adn.isReceiver) {
        <div class="adn-title-buttons">
          <div class="gray-but-wrap">
            <div class="white-border-top">
              <a class="btn" href="@adnShowType.lkProducersShowCall(node.id.get)">АРЕНДАТОРЫ</a>
            </div>
          </div>

          <div class="gray-but-wrap">
            <div class="white-border-top">
              <a id="installScriptButton" class="btn" href="">КОД УСТАНОВКИ</a>
            </div>
          </div>
        </div>
      }
    </div>
  </div>

  <div class="body">
    <div class="shop-info">

      <div class="name-wrap" style="padding-bottom: 0px;">
        <span class="name">@node.meta.name</span>
        <a class="edit" href="@adnShowType.lkNodeEditCall(node.id.get)">Редактировать</a>
        @if(isSuperuser) {
          <a class="superuser-link" href="@adnShowType.sysShow(node.id.get)">/sys</a>
        }
      </div>

      <div class="sm-note">
        Подсказка : в редактировани вы можете указать информацию о вашем магазине и загрузить основной логотип, который будет отображаться на всех рекламных карточках.
      </div>

      <div class="border-line"></div>

      @if(node.meta.town.isDefined) {
        <div class="name-wrap">
          @node.meta.town@if(node.meta.address.isDefined) {, @node.meta.address}
        </div>
        <div class="border-line"></div>
      }

      @if(node.meta.description.isDefined) {
        <table class="block">
          <tr>
            @_nodeDescrTdTpl(node, style = "border-left: none; padding-left: 0;")
          </tr>
        </table>
      }
    </div>

    @* Если указаны этаж/секция, то их напечатать таблицей. *@
    @if(node.meta.floor.isDefined || node.meta.section.isDefined) {
      @_floorSectionTableTpl(node)
      <div class="border-line"></div>
    }

    @* Для тех, кто может создавать свою рекламу, рисуем список своих рекламных карточек с галочками. *@
    @if(node.adn.isProducer) {
      @_myAdsTpl(node, myAds, fallbackLogo)
    }
  </div>

  @* Обладают выдачей только ресиверы, поэтому окно с кодом рендерится только для них. *@
  @if(node.adn.isReceiver) {
    @_installScriptPopupTpl(node)
  }

  @* Супервизору надо отрендерить табличку подчиненых узлов: для реализации надзорных полномочий. *@
  @if(node.adn.isSupervisor) {
    @_supShowNodesTpl(node, supervisedNodes)
  }

} @* defining AdnShowType *@
}
