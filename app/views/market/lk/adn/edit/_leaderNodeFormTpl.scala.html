@(adnId:String, btnText: String, mf: Form[_], submitCall:Call, welcomeAdOpt: Option[MAdT], nodeInfo: AdNetMemberInfo)(implicit ctx: util.Context)

@* Форма для создания/редактирования торгового центра через личный кабинет. *@
@import helper._
@import util.FC.tdRadialFc
@import util.img.GalleryUtil.GALLERY_LEN_MAX

@form(submitCall, 'id -> "profileEdit") {

  <div class="profile_logo-bar" id="logo">
    @defining(mf("logoImgId").value) { logoImgIdOpt =>
      @logoImgIdOpt.filter(!_.isEmpty).map { imgId =>
        <style class="custom-color-style" data-for=".__logo">
          .__logo {
            background-color: #@mf("meta.color").value;
          }
        </style>
        <div class="image __logo __size-L js-preview">
          <input class="js-image-key" type="hidden" name="logoImgId" value="@logoImgIdOpt"/>
          <img class="image_src" src='@routes.Img.getImg(imgId)'/>
          <a class="image_remove-btn js-remove-image" title="Удалить">
            <span></span>
          </a>
        </div>
      }

      <div class="image __size-L js-image-upload" @if(!logoImgIdOpt.isEmpty){ style="display: none;" }>
        @stuff._fileUploadTpl(
          routes.MarketLkAdnEdit.handleTempLogo(),
          fieldName = "logoImgId",
          previewRoot = "#logo",
          previewClass = "__logo __size-L"
        )
        <a class="image_add-btn js-file-upload-btn" title="Загрузить логотип">
         <span>Загрузить<br/>логотип</span>
        </a>
      </div>

    }
  </div>

  <div class="profile_info-bar">
    <hr class="delimiter __light"/>

    @mf.globalError.map { errors =>
      <p class="block __margin-M red">Ошибка: @Messages(errors.message)</p>
    }

    @inputText(
      mf("meta.name"),
      '_label -> "Название"
    )

    @inputText(
      mf("meta.town"),
      '_label -> "Город"
    )

    @textarea(
      mf("meta.address"),
      '_label -> "Адрес"
    )

    @inputText(
      mf("meta.siteUrl"),
      '_label -> "Сайт"
    )

    @if(nodeInfo.isProducer || nodeInfo.isReceiver) {
      @textarea(
        mf("meta.info"),
        '_label -> "Информация о товарах или услугах"
      )
    }

    <hr class="delimiter __light"/>

    @if(nodeInfo.isReceiver) {
      @inputText(
        mf("meta.humanTrafficAvg"),
        '_label -> "Суточный трафик"
      )

      @textarea(
        mf("meta.audienceDescr"),
        '_label -> "Описание аудитории"
      )
      <hr class="delimiter __light"/>

      <div class="prop" >
        <p class="prop_name __block">Экран приветствия:</p>
        @_welcomeAdFormTpl(adnId, welcomeAdOpt, mf)
      </div>

      <hr class="delimiter __light"/>

      <div class="prop" id="profileGallery">
        <p class="prop_name __block">Фотографии объекта:</p>

        <div class="image __size-M f-left js-image-upload" >
          @stuff._fileUploadTpl(
            routes.Img.handleTempImg,
            fieldName = "gallery",
            multiple = true,
            previewRoot = "#profileGallery",
            previewClass = "__size-M f-left"
          )
          <a class="image_add-btn js-file-upload-btn" title="Загрузить фотографию">
            <span>Добавить<br/>фотографию</span>
          </a>
        </div>

        @* Рендерим существующие значения. gf - поле, gfi - индекс картинки (1, 2, 3), gfn - имя поля в индексе ("gallery[0]") *@
        @defining( mf("gallery") ) { gf =>
          @gf.indexes.map { gfi =>
            @defining( s"gallery[$gfi]" ) { gfn =>
              @mf(gfn).value.map { imgId =>
                <div class="image __size-M f-left js-preview @if(gfi % 4 == 2){ __last-in-line}">
                  <input class="js-image-key" type="hidden" name="@gfn" value="@imgId"/>
                  <img class="image_src" src="@routes.Img.getThumb(imgId)" />
                  <a class="image_remove-btn js-remove-image" title="Удалить">
                    <span></span>
                  </a>
                </div>
              }
            }
          }
        }
      </div><!-- profile gallery end -->

      <hr class="delimiter __light"/>

    }

    <table class="prop">
      <td class="prop_name td">
        Цвет фона шапки где будет распологаться ваш логотип
      </td>
      <td class="td __color-title">
        <span class="dark-gray ft-S">Основной<br/>цвет</span>
      </td>
      <td class="td __padding-S">
        <div class="color __select js-custom-color" data-for=".__logo" style="background-color: #@mf("meta.color").value;">
          <input type="hidden" name="meta.color" value="@mf("meta.color").value"/>
        </div>
      </td>
      <td class="td __padding-S">
        <div class="delimiter __light __vertical js-vertical-line"></div>
      </td>
      <td class="td __padding-S prop_name">
        Цвет текста и иконок категорий в ленте выдачи <a class="link js-btn" href="#editHelp">?</a>
      </td>
      <td class="td __color-title">
        <span class="dark-gray ft-S">Цвет<br/>контента</span>
      </td>
      <td class="td __padding-S dark-gray">
        <div class="color __select js-custom-color" style="background-color: #@mf("meta.fgColor").value;">
          <input id="meta_color" type="hidden" name="meta.fgColor" value="@mf("meta.fgColor").value"/>
        </div>
      </td>
    </table>

  </div>


    @*<table cellpadding="0" cellspacing="0" class="input-w __size-L">
      <tr>

        <td class="input-w_left">
          <label class="input-w_prop-name" for="logoImgInput">Логотип</label>
        </td>

        <td>

          @defining(mf("logoImgId").value) { logoImgIdOpt =>

            @logoImgIdOpt.filter(!_.isEmpty).map { imgId =>
              <div class="add-file-w __preview">
                <input class="js-image-key" type="hidden" name="logoImgId" value="@logoImgIdOpt"/>
                <img class="add-file-w_image js-image-preview" src="@routes.Img.getImg(imgId)" />
                <a class="add-file-w_btn siom-remove-image-btn js-remove-image" title="Удалить файл"></a>
              </div>
            }

            <div class="add-file-w __size-S"  @if(!logoImgIdOpt.isEmpty) {style="display: none;"}>
              @stuff._fileUploadTpl(
                routes.MarketLkAdnEdit.handleTempLogo(),
                fieldName = "logoImgId",
              )
              <a class="add-file-w_btn siom-add-image-btn js-file-upload-btn" title="Загрузить файл"></a>
            </div>

          }

        </td>

      </tr>
    </table>*@



    @if(false) {
      <table cellpadding="0" cellspacing="0" class="input-w __size-L">

        <tbody>
          <tr>
            <td class="input-w_left">
              <label class="input-w_prop-name">Картинка приветствия:</label>
            </td>
            <td>
              @_welcomeAdFormTpl(adnId, welcomeAdOpt, mf)
            </td>
          </tr>
        </tbody>

      </table>



      <table cellpadding="0" cellspacing="0" class="input-w __size-L">

        <tr>
          <td class="input-w_left">
            <label class="input-w_prop-name" for="logoImgInput">Фотографии<br/>объекта:</label>
          </td>

          <td>

            @* Рендерим существующие значения. gf - поле, gfi - индекс картинки (1, 2, 3), gfn - имя поля в индексе ("gallery[0]") *@
            @defining( mf("gallery") ) { gf =>
              @gf.indexes.map { gfi =>
                @defining( s"gallery[$gfi]" ) { gfn =>
                  @mf(gfn).value.map { imgId =>
                    <div class="add-file-w __preview">
                      <input class="js-image-key" type="hidden" name="@gfn" value="@imgId"/>
                      <img class="add-file-w_image js-image-preview" src="@routes.Img.getThumb(imgId)" />
                      <a class="add-file-w_btn siom-remove-image-btn js-remove-image" title="Удалить файл"></a>
                    </div>
                  }
                }
              }

              <div class="add-file-w __size-S" >
                @stuff._fileUploadTpl(
                  routes.Img.handleTempImg,
                  fieldName   = "gallery",
                  multiple = true
                )
               <a class="add-file-w_btn siom-add-image-btn js-file-upload-btn" title="Загрузить файл"></a>
              </div>

            }

          </td>
        </tr>

      </table>
    }

}
