@(adnId:String, btnText: String, mf: Form[_], submitCall:Call, welcomeAdOpt: Option[MAdT], nodeInfo: AdNetMemberInfo)(implicit ctx: util.Context)

@* Форма для создания/редактирования торгового центра через личный кабинет. *@
@import helper._
@import util.FC.tdFc
@import util.img.GalleryUtil.GALLERY_LEN_MAX

@form(submitCall) {

    <table cellpadding="0" cellspacing="0" class="input-w __size-L">
      <tr>

        <td class="input-w_left">
          <label class="input-w_prop-name" for="logoImgInput">Логотип</label>
        </td>

        <td>

          @defining(mf("logoImgId").value) { logoImgIdOpt =>

            @logoImgIdOpt.filter(!_.isEmpty).map { imgId =>
              <div class="add-file-w __preview">
                <input class="js-image-key" type="hidden" name="logoImgId" value="@logoImgIdOpt"/>
                <img class="add-file-w_image js-image-preview" src="@routes.Img.getImg(imgId)" />
                <a class="add-file-w_btn siom-remove-image-btn js-remove-image" title="Удалить файл"></a>
              </div>
            }

            <div class="add-file-w __size-S"  @if(!logoImgIdOpt.isEmpty) {style="display: none;"}>
              @stuff._fileUploadTpl(routes.MarketLkAdnEdit.handleTempLogo(), fieldName = "logoImgId")
              <a class="add-file-w_btn siom-add-image-btn js-file-upload-btn" title="Загрузить файл"></a>
            </div>

          }

        </td>

      </tr>
    </table>

    <table cellpadding="0" cellspacing="0" class="input-w __size-L">
      @inputText(
        mf("meta.name"),
        '_label -> "Название:"
      )
    </table>

    <table cellpadding="0" cellspacing="0" class="input-w __size-L">
      @inputText(
        mf("meta.town"),
        '_label -> "Город:"
      )
    </table>

    <table cellpadding="0" cellspacing="0" class="input-w __size-L __textarea">
      @textarea(
        mf("meta.address"),
        '_label -> "Адрес:"
      )
    </table>


    <table class="input-w __size-L" cellspacing="0" cellpadding="0">

      <td class="input-w_left">
        <label class="input-w_prop-name" for="meta_color">Основной цвет:</label>
      </td>
      <td class="input-w_right">
        <div class="lk-color-select__color lk-color-select__color_custom js-custom-color" style="background: #@mf("meta.color").value;">
          <div></div>
          <input id="meta_color" type="hidden" name="meta.color" value="@mf("meta.color").value"/>
        </div>
      </td>

      <td class="input-w_left">
        <label class="input-w_prop-name" for="meta_color">Цвет текста:</label>
      </td>
      <td class="input-w_right">
        <div class="lk-color-select__color lk-color-select__color_custom js-custom-color" style="background: #@mf("meta.fgColor").value;">
          <div></div>
          <input id="meta_color" type="hidden" name="meta.fgColor" value="@mf("meta.fgColor").value"/>
        </div>
      </td>

    </table>


    <table cellpadding="0" cellspacing="0" class="input-w __size-L">
      @inputText(
        mf("meta.siteUrl"),
        '_label -> "Сайт:"
      )
    </table>

    @if(nodeInfo.isReceiver) {
      <table cellpadding="0" cellspacing="0" class="input-w __size-L __textarea">
        @textarea(
          mf("meta.audienceDescr"),
          '_label -> "Описание \n аудитории:"
        )
      </table>
      <table cellpadding="0" cellspacing="0" class="input-w __size-L">
        @inputText(
          mf("meta.humanTrafficAvg"),
          '_label -> "Суточный трафик:"
        )
      </table>
    } else {
      @if(nodeInfo.isProducer) {
        <table cellpadding="0" cellspacing="0" class="input-w __size-L __textarea">
          @textarea(
            mf("meta.info"),
            '_label -> "Информация о товарах или услугах:"
          )
        </table>
      }
    }

    @if(nodeInfo.isReceiver) {
      <table cellpadding="0" cellspacing="0" class="input-w __size-L">

        <tbody>
          <tr>
            <td class="input-w_left">
              <label class="input-w_prop-name">Картинка приветствия:</label>
            </td>
            <td>
              @_welcomeAdFormTpl(adnId, welcomeAdOpt, mf)
            </td>
          </tr>
        </tbody>

      </table>



      <table cellpadding="0" cellspacing="0" class="input-w __size-L">

        <tr>
          <td class="input-w_left">
            <label class="input-w_prop-name" for="logoImgInput">Фотографии<br/>объекта:</label>
          </td>

          <td>

            @* Рендерим существующие значения. gf - поле, gfi - индекс картинки (1, 2, 3), gfn - имя поля в индексе ("gallery[0]") *@
            @defining( mf("gallery") ) { gf =>
              @gf.indexes.map { gfi =>
                @defining( s"gallery[$gfi]" ) { gfn =>
                  @mf(gfn).value.map { imgId =>
                    <div class="add-file-w __preview">
                      <input class="js-image-key" type="hidden" name="@gfn" value="@imgId"/>
                      <img class="add-file-w_image js-image-preview" src="@routes.Img.getThumb(imgId)" />
                      <a class="add-file-w_btn siom-remove-image-btn js-remove-image" title="Удалить файл"></a>
                    </div>
                  }
                }
              }

              <div class="add-file-w __size-S" >
                @stuff._fileUploadTpl(routes.Img.handleTempImg, fieldName = "gallery", multiple = true)
               <a class="add-file-w_btn siom-add-image-btn js-file-upload-btn" title="Загрузить файл"></a>
              </div>

            }

          </td>
        </tr>

      </table>
    }


  <div class="border-line"></div>

  <div class="submit-w __size-M">
    <a class="siom-ac-btn __size-M __color-2 __ft-XM js-submit-btn f-right">@btnText</a>
  </div>

}
