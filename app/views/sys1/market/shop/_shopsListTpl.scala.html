@(shops: Seq[MShop], withCompany:Option[Option[MCompany]] = None, withMart:Option[Option[MMart]] = None)(implicit ctx: util.CtxWithSqlConn)

@* Рендер списка магазинов. *@
@import ctx._

<table>
  <tr>
    <th>@Messages("Name")</th>
    @if(withCompany.isDefined) { <th>@Messages("Company")</th> }
    @if(withMart.isDefined) { <th>ТЦ</th> }
  </tr>
  @shops.map { shop =>
    <tr>
      <td>@shop.name</td>
      @withCompany.map { maybeCompany =>
        <td>
          <a href="@routes.SysMarket.companyShow(shop.company_id)">
            @maybeCompany.getOrElse(shop.company).name
          </a>
        </td>
      }
      @withMart.map { maybeMart =>
        <td>
          @defining(maybeMart.getOrElse(shop.mart)) { mmart =>
            @* a.title: Нужно экранировать/срезать ковычки, чтобы разметка не поехала. *@
            <a href="@routes.SysMarket.martShow(shop.mart_id)" title="@mmart.address">@mmart.name</a>
            @mmart.site_url.map { siteUrl =>
              <a href="@siteUrl">&#x1f30d;</a>
            }
          }
        </td>
      }
    </tr>
  }
</table>


