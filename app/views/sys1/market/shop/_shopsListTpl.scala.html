@(shops: Seq[MAdnNode], companies: Option[Map[CompanyId_t, MCompany]] = None, marts:Option[Map[String, MAdnNode]] = None)(implicit ctx: util.Context)

@* Рендер списка магазинов. *@
@import ctx._

<table>
  <tr>
    <th>@Messages("Name")</th>
    @if(companies.isDefined) { <th>@Messages("Company")</th> }
    @if(marts.isDefined) { <th>ТЦ</th> }
  </tr>
  @shops.map { mshop =>
    <tr>
      <td><a href="@routes.SysMarket.showAdnNode(mshop.id.get)">@mshop.meta.name</a></td>
      @companies.map { _companies =>
        <td>
          @_companies.get(mshop.companyId).map { mc =>
            <a href="@routes.SysMarket.companyShow(mc.id.get)">@mc.name</a>
          }
        </td>
      }
      @mshop.adn.supId.map { shopMartId =>
        @marts.map { _marts =>
          <td>
            @_marts.get(shopMartId).map { mmart =>
              @* a.title: Нужно экранировать/срезать ковычки, чтобы разметка не поехала. *@
              <a href="@routes.SysMarket.martShow(shopMartId)" title="@mmart.meta.address">@mmart.meta.name</a>
              @mmart.meta.siteUrl.map { siteUrl =>
                <a href="@siteUrl">&#x1f30d;</a> @* Тут символ глобуса, который почти ни у кого нормально не отображается. *@
              }
            }
          </td>
        }
      }
    </tr>
  }
</table>


