@(call:Call, sf: Form[_], btnText:String, companies:Seq[MCompany], marts:Seq[MAdnNode])(implicit ctx: util.Context)

@* Форма для добавления/редактирования магазинов в системной админке. *@
@import helper._
@import ctx._

@form(call) {
  @inputText(sf("meta.name"))

  <br/>
  @* Компания, к которой принадлежит магазин. В продакшене это будет задаваться неявно. *@
  @defining(sf("companyId")) { ciField =>
    @defining(ciField.value.orElse(request.getQueryString("company_id")).getOrElse("")) { currCompanyId =>
    <select name="@ciField.name">
      <option disabled>@Messages("Company")-@Messages("Owner")</option>
      @companies.map { mcompany =>
        <option value="@mcompany.id.get"@if(currCompanyId == mcompany.id.get) {selected}>@mcompany.name</option>
      }
    </select>
    }
  }

  @* Торговый центр, к которому привязан магазин. В продакшене это будет задаваться неявно. *@
  @defining(sf("martId")) { miField =>
    <select name="@miField.name">
      <option disabled>@Messages("Mart")</option>
      @defining(miField.value.orElse(request.getQueryString("mart_id")).getOrElse("")) { currMartId =>
        @marts.map { mmart =>
          <option value="@mmart.id.get"@if(currMartId == mmart.id.get) {selected}>@mmart.meta.name</option>
        }
      }
    </select>
  }

  <br/><br/>
  @* Опциональный номер этажа в ТЦ. *@
  @inputText(
    sf("meta.floor"),
    'placeholder -> 1,
    '_label -> "Этаж"
  )

  <br/>
  @* Опциональный номер секции в ТЦ. *@
  @inputText(
    sf("meta.section"),
    'placeholder -> 101,
    '_label -> "Номер секции"
  )

  <br/>
  @textarea(
    sf("meta.descr"),
    '_label -> "Описание магазина"
  )

  <br/>
  @inputText(
    sf("l3maxAds"),
    '_label -> "Макс.кол-во рекл.карточек на уровне магазина"
  )

  <input type="submit" value="@btnText"/>
}
