@(af: Form[_], call: Call, companies: Seq[MCompany], btnText: String)(implicit ctx: util.Context)

@* Форма для создания/редактирования торгового центра. *@
@import helper._
@import ctx._

@form(call) {
  @* ADN *@
  <label>Тип узла ADN
    @defining(af("adn.memberType")) { mtField =>
      <select name="@mtField.name">
        <option disabled>Тип узла</option>
        @AdNetMemberTypes.values.map { anmt =>
          <option value="@anmt.name" @if(mtField.value.exists(_ == anmt.name)) {selected}>@Messages("amt.of.type." + anmt.name)</option>
        }
      </select>
    }
  </label>
  @checkbox(af("adn.isEnabled"), '_label -> "Включён?")


  @* Компания, к которой принадлежит узел. В продакшене это задаётся неявно. *@
  @defining(af("companyId")) { ciField =>
    @defining(ciField.value.orElse(request.getQueryString("company_id")).getOrElse("")) { currCompanyId =>
      <select name="@ciField.name">
        <option disabled>@Messages("Company")-@Messages("Owner")</option>
        @companies.map { mcompany =>
          <option value="@mcompany.id.get"@if(currCompanyId == mcompany.id.get) {selected}>@mcompany.name</option>
        }
      </select>
    }
  }


  @* meta *@
  @inputText(af("meta.name"),    '_label -> "Название")
  @textarea(af("meta.descr"),    '_label -> "Описание объекта")
  @inputText(af("meta.town"),    '_label -> "Город")
  @inputText(af("meta.address"), 'placeholder -> "пр.Ленина, д.1",  '_label -> "Адрес в городе")
  @inputText(af("meta.phone"),   'placeholder -> "+78121234567",    '_label -> "Номер телефона")
  @inputText(af("meta.floor"),   'placeholder -> 1,                 '_label -> "Этаж")
  @inputText(af("meta.section"), 'placeholder -> 101,               '_label -> "Номер секции")
  @inputText(af("meta.siteUrl"), 'placeholder -> "http://",         '_label -> "Адрес сайта в интернете")
  @inputText(af("meta.color"),   'placeholder -> "cceeff",          '_label -> "Цвет")

  @* conf *@
  @inputText(af("conf.withBlocks"), 'placeholder -> "1, 2, 3",      '_label -> "Доп.id блоков")

  <div>
    @AdnRights.values.map { adnRight =>
      @checkbox(af(s"adn.rights.${adnRight.longName}"), '_label -> adnRight.longName)
    }
  </div>

  @inputText(af("adn.sls.in"),  '_label -> "Входящие уровни отображения и лимиты")
  @inputText(af("adn.sls.out"), '_label -> "Исходящие уровни отображения и лимиты")

  <p>Формат: 'd = 1, m = 20, h = 5'.<br/>
  @AdShowLevels.values.map { sl =>
    @sl.name -- @Messages("lk.sl." + sl.name),
  }</p>

  @inputText(af("adn.supId"), '_label -> "id узла-супервизора, если есть.")
  @inputText(
    af("adn.advDelegate"),
    '_label -> "id узла-делегата рекламного размещения, если есть.",
    'title  -> "Входящие запросы рекламного размещения будут отправляться к указанному узлу, а не к текущему."
  )

  <input type="submit" value="@btnText"/>
}
