@(title: String, leftCurrEl: Option[LkLeftPanelLink] = None, nodeOpt: Option[MNode] = None,
  headAfter:Option[Html] = None, popupContent: Option[Html] = None,
  povAdnId: Option[String] = None, showSwitchNodeBtn: Boolean = true)(content: Html)(implicit ctx: Context)

@* Базовый шаблон для личного кабинета sio-маркета (не важно: ТЦ или магазин). *@

@import ctx._
@import stuff._
@import lk.popup._
@import lk.left._
@import helper._
@import io.suggest.popup.PopupConstants

<!DOCTYPE html>
<html>
<head>
  <title>@title @if(nodeOpt){ | @_nodeTitleTpl(nodeOpt) } | Suggest.io</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

  <link rel="stylesheet" type="text/css" href='@routes.Assets.versioned("stylesheets/market/lk/common.css")'/>
  <link rel="stylesheet" type="text/css" href='@routes.Assets.versioned("stylesheets/market/showcase.css")'/>

  <link rel="stylesheet" type="text/css" href='@routes.Assets.versioned("stylesheets/market/lk_new-design/lk.css")'/>

  <script src='@routes.Assets.versioned("javascripts/jquery.min.js")'></script>

  @static._faviconTpl()

  @headAfter
</head>

<body class="lk" @_initRouterAttrsTpl()>
@defining( nodeOpt.flatMap(_.id) ) { adnIdOpt =>

  <header class="header">
    <a class="header_logo-link" href="@routes.MarketLkAdn.lkList(fromNode = nodeOpt.flatMap(_.id))">
      <img class="header_logo-image" src='@routes.Assets.versioned("images/market/new-design/logo_retina.png")' alt="logo" width="53" height="51"/>
    </a>

    <div class="header_cnt">

      @if(nodeOpt.isEmpty) {
        <img class="header_logo-text" src='@routes.Assets.versioned("images/market/index/logo_retina.png")' width="101" height="26"/>
      } else {
        @nodeOpt.map { mnode =>
          <span class="header_logo-text">@mnode.meta.basic.name</span>
        }
      }

      @adnIdOpt.map { adnId =>
        @* Виджет для отображения денег на счете и доступа к финансовым функциям. Только в контексте узла. *@
        @billing._billBallanceWidgetTpl(adnId)
      }
    </div>

    <a class="lang-widget" title="Switch language@if(messages.lang.language != "en") { | @messages("Switch.lang")}"
       href="@routes.LkLang.showLangSwitcher(r = ctx.r)">@ctx.messages.lang.language</a>

    @if(showSwitchNodeBtn && ctx.isAuth) {
      <a class="btn __size-M __major header_change-node"
         href="@routes.MarketLkAdn.lkList(fromNode = nodeOpt.flatMap(_.id))">
        @messages("Switch.shop")
      </a>
    }

  </header>


  <section class="page">

    @_flashMsgTpl()

    @_nodeLeftBarTpl(adnIdOpt, leftCurrEl, povAdnId)

    @content

  </section>


  <aside class="popups popups-container" id="@PopupConstants.CONTAINER_ID">

    @_popupTpl(css = Seq("__size-M"), id = Some("logoutPopup")) {
      <h2 class="minor-title">@messages("Logout.suggest.io")</h2>
      <div class="btn-w __size-M">
        <a class="btn __minor __size-M @PopupConstants.CLOSE_CSS_CLASS">@messages("Cancel")</a>
        <a class="btn __major __size-M __list" href="@CSRF(routes.Ident.logout())">@messages("Logout")</a>
      </div>
    }

    @popupContent
  </aside>


  <script src="@routes.Assets.versioned("javascripts/market/lk/mx_cof.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/jquery-ui.custom.min.js")"></script>

  @_sjsScript("lk-sjs", withLauncherJs = true)
}
</body>
</html>
