@(args: adv.gtag.IForAdTplArgs)(middle: Html)(implicit ctx: Context)

@* Шаблон формы размещения карточки в тегах с географией. *@

@import ctx.{messages, request}
@import helper._
@import util.FC.tdRadialFc
@import io.suggest.common.maps.rad.RadMapConstants._
@import stuff._inputHiddenTpl
@import stuff.geo._
@import lk.tag.edit._


@* js-форма добавления тегов. *@
@_addFormTpl(args.form)

@* Кнопка добавления тега. Вне формы, т.к. форма перезаписывается после сабмитов. *@
@_addBtnTpl()

@form( CSRF(routes.LkAdvGeoTag.forAdSubmit(args.mad.id.get)) ) {

  @* Рендер сохранённых тегов. *@
  @_existTagsContTpl() {
    @_tagsExistTpl(args.form)
  }

  @* Для сохранения и восстановления состояния карты при POST нужны hidden-поля в рамках формы. *@
  @defining( args.form("map") ) { mf =>

    @_hiddenLatLonTpl(
      f = mf("center"),
      latId = Some(INPUT_ID_LAT),
      lonId = Some(INPUT_ID_LON)
    )

    @* Состояние зума карты. *@
    @_inputHiddenTpl(
      mf("zoom"),
      id = Some(INPUT_ID_ZOOM)
    )
  }

  @* Сохранение данных круга на карте (области) присходит здесь. *@
  @defining( args.form("circle") ) { cf =>

    @_hiddenLatLonTpl(
      cf("center"),
      latId = Some(INPUT_ID_CIRCLE_LAT),
      lonId = Some(INPUT_ID_CIRCLE_LON)
    )
    @_inputHiddenTpl(
      cf("radius"),
      id = Some(INPUT_ID_CIRCLE_RADIUS)
    )

  }

  @* Какой-то контент внутри формы после тегов. Карта например. *@
  @middle


  @* TODO Нормальная кнопка для сабмита, ценник, etc *@
  <input type="submit" value="@messages("Advertise")" />

}
