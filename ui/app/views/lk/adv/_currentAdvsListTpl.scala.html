@(args: CurrentAdvsTplArgs)(implicit ctx: Context)

@* Список размещений какой-то рекламной карточки. *@

@import MAdvModes._
@import ctx._
@import datetime._
@import util.TplDataFormatUtil._
@import args._

@_single_status(statusClass: String, node: MNode)(content: Html) = {
  <div class="adv-status_i __@statusClass">
    <span class="ft-M light-gray f-left">
      @node.meta.basic.name
      @node.meta.address.town.map { town => / @town }
    </span>
    @content
  </div>
}

<hr class="delimiter __light"/>
<div class="adv-status_lst">

  @if(advs.size == 0) {
    @messages("No.history")
  }

  @advs.zipWithIndex.map { case(adv, i) =>
    @adv2adn.get(adv.id.get).map { node =>

      @* dateStatus - одобрение, dateStart - начало размещения. *@
      @adv match {
        case advOk: MAdvOk => {
          @_single_status( "approved", node ) {
            <span class="green">@messages("Approved._adv")</span> <span class="adv-status_i-time">@_prettyDate(advOk.dateStatus)</span>
          }
        }
        case advReq: MAdvReq => {
          @_single_status( "pending", node ) {
            @messages("Under.consideration") <span class="adv-status_i-time">@_prettyDate(advReq.dateStatus)</span>
          }
        }
        case advRefused: MAdvRefuse => {
          @* TODO А где reason должен отображаться? *@
          @_single_status( "declined", node ) {
            <span class="red">@messages("Denied")</span> <span class="adv-status_i-time">@_prettyDate(advRefused.dateStatus)</span>
          }
        }
      }

    }

  }

</div>

@* сворачивалка списка операции, вернуть при надобности *@
@*<button class="btn __helper __size-S adv-status_btn f-right js-slide-btn" href="#adOperationHistory">@messages("Show.all")</button>*@

