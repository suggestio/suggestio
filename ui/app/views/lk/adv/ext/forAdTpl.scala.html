@(mad: MAd, mnode: MAdnNode, targets: Seq[adv.MExtTarget], currentAdvs: Map[String, adv.MExtAdv], af: Form[_])(implicit ctx: Context)

@* Страница со формой размещения рекламной карточки на внешних сервисах. *@

@import ctx._
@import helper._

@base("Внешнее размещение карточки", mnode) {

  @form( routes.LkAdvExt.advFormSubmit(mad.id.get) ) {

    @* Сообщения о проблемах с выборкой. СВЕРСТАТЬ, А НЕ КОММЕНТИТЬ КАК ОБЫЧНО! *@
    @af("adv").errors.map { error =>
      <p>Возникла проблема: @Messages(error.message, error.args)</p>
    }

    @targets.iterator.zipWithIndex.map { case (target, i) =>
      <input type="hidden" name="adv[@i].targetId" value="@target.id" />
      <label>
        <input type="checkbox" name="adv[@i].enabled" value="true" style="display: block;" />
        @Messages(target.service.i18nCode)
        @target.name
      </label>
    }

    <a href="@routes.LkAdvExt.createTarget(mnode.id.get)">Добавить цель...</a>

    <script src="//vk.com/js/api/openapi.js" type="text/javascript"></script>

    <!--<script language="javascript">


      function authInfo(response) {
        if (response.session) {
          console.log('user: '+response.session.mid);
        } else {
          console.log('not auth');
        }
      }

      //VK.Auth.getLoginStatus(authInfo);
      //VK.UI.button('login_button');

      VK.Api.call('account.getAppPermissions', {user_id: 1717555}, function(r) {
        console.log("-----");
        console.log(r);
        if(r.response) {
          console.log(r.response);
        }
      });

      VK.Api.call('photos.getWallUploadServer', {user_id: 1717555}, function(r) {
        if(r.response) {
          console.log(r.response);
        }
      });

      VK.Api.call('users.get', {uids: 1717555}, function(r) {
        if(r.response) {
          console.log('Привет, ' + r.response[0].first_name);
        }
      });
    </script>-->




    <input type="submit" value="Начать размещение..." />
  }

}
