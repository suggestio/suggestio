@(martId: String, welcomeAdOpt: Option[MAdT], mf: Form[_])(implicit ctx: Context)

@* Форма для выставления приветственной картинки-карточки. *@
@import ctx._
@import helper._
@import util.img.DynImgUtil
@import io.suggest.img.ImgConstants
@import io.suggest.adn.edit.NodeEditConstants
@import io.suggest.js.UploadConstants.JS_IMG_UPLOAD_CLASS

<table class="prop">
  <tr>
    <td class="prop_name td">@messages("Welcome.bg.hint")</td>
    <td class="td" id="@NodeEditConstants.NODE_WELCOME_DIV_ID">
      @defining(mf("welcomeImgId").value) { imgIdOpt =>

        @defining(welcomeAdOpt.flatMap(_.imgs.headOption).map(_._2.filename)) { welcomeAdIdOpt =>
          @welcomeAdIdOpt.filter(!_.isEmpty).map { imgId =>
            <div class="image __size-M @ImgConstants.JS_PREVIEW_CLASS">
              <input class="@ImgConstants.JS_IMG_ID_CLASS" type="hidden" name="welcomeImgId" value="@imgIdOpt"/>
              <img class="image_src" src="@DynImgUtil.thumb256Call(imgId, fillArea = false)" />
              <a class="image_remove-btn @ImgConstants.JS_REMOVE_IMG_CLASS" title="@messages("Delete")">
                <span></span>
              </a>
            </div>
          }
        }

        <div class="image __size-M f-left @JS_IMG_UPLOAD_CLASS" @if(!imgIdOpt.isEmpty) {style="display: none;"}>
          @stuff._fileUploadTpl(
            call          = routes.MarketLkAdnEdit.handleTempLogo,
            fieldName     = "welcomeImgId",
            previewRoot   = "#" + NodeEditConstants.NODE_WELCOME_DIV_ID,
            previewClass  = "__size-M f-left"
          )
          <a class="image_add-btn js-file-upload-btn" title="@messages("Upload.image")">
            <span>@Html( messages("Upload.image", "<br/>") )</span>
          </a>
        </div>
      }
    </td>

    <td class="td"></td>
  </tr>
</table>
