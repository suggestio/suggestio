@(title: String, node: MAdnNode, isMyNode: Boolean, rightCurrEl: NodeRightPanelLink, povAdnIdOpt: Option[String] = None,
  popupContent:Option[Html] = None, rightBarAfter: Option[Html] = None)(content: Html)(implicit ctx: Context)


@import lk.adn.node._
@import ctx._
@import NodeRightPanelLinks._
@import lk.right._

@rightBarBody(adnId: String) = {
  @_navItemTpl(
    title = Messages("Profile"),
    href  = Some( routes.MarketLkAdn.showAdnNode(adnId) ),
    css   = Seq("__show-profile", if(rightCurrEl == RPL_NODE) "__act" else "")
  )

  @if(isMyNode) {
    @_navItemTpl(
      title = Messages("Edit.profile"),
      href  = Some( routes.MarketLkAdnEdit.editAdnNode(adnId) ),
      css   = Seq("__edit-profile", if(rightCurrEl == RPL_NODE_EDIT) "__act" else "")
    )

    @_navItemTpl(
      title = Messages("Password.change"),
      href  = Some( routes.MarketLkAdn.userProfileEdit(adnId, r = ctx.r) ),
      css   = Seq("__change-pass", if(rightCurrEl == RPL_USER_EDIT) "__act" else "")
    )

    @if(node.adn.isReceiver) {
      @_navItemTpl(
        title = Messages("Advertisers"),
        href  = Some( routes.MarketAdv.showNodeAdvs(adnId) ),
        css   = if (rightCurrEl == RPL_ADVERTISERS) Seq("__act") else Nil
      )
    }
  }
}

@* Билдим содержимое правой панели. *@
@rightBar1 = {
  @node.id.map { adnId =>
    @_navTpl( Some(routes.SysMarket.showAdnNode(adnId)) ) {
      @rightBarBody(adnId)
    }
  }

  @rightBarAfter
}


@lk.lkBaseLayout(
  title         = title,
  leftCurrEl    = Some(LkLeftPanelLinks.LPL_NODE),
  nodeOpt       = Some(node),
  rightBar      = Some(rightBar1),
  povAdnId      = povAdnIdOpt,
  popupContent  = popupContent
)(content)
