@(args: mlk.bill.ICartTplArgs)(implicit ctx: Context)

@* Шаблон с корзиной. *@

@import lk.billing.billingBaseTpl
@import ctx.messages
@import sys1.stuff.ntable._
@import util.TplDataFormatUtil.formatPrice
@import views.html.sc._adNormalTpl

@billingBaseTpl(
  title       = messages("Cart"),
  mnode       = args.mnode,
  rightCurrEl = BillingRightPanelLinks.RPL_CART
) {

  @* TODO Вынести totalPrice в right panel и кнопку оплатить туда же. *@
  <div>
    Общая стоимость:
    @for((_, mprice) <- args.totalPrices) {
      @formatPrice(mprice)
    }
  </div>

  @for(r <- args.r) {
    <a href="@r">Вернутся назад</a>
  }

  @_ntable() {

    @_td("L") {
      @messages("Item")
    }
    @_td("S") {
      @messages("Price")
    }

  } {

    @* TODO Дедублицировать рендер карточки *@
    @for(itm <- args.items; mitem <- itm.mitems) {

      @* Нарисовать тут маленькую рекламную карточку *@
      @_td("S") {
        @_adNormalTpl(itm.brArgs)
      }

      @* Суть оффера. Инфа по заказанным тегам например. *@
      @_td("M") {
        @for(tag <- mitem.tagFaceOpt) {
          <span>#@tag</span>
        }
      }

      @* Рендер стоимости item'а *@
      @_td("S") {
        @formatPrice(mitem.price)
      }

    } @* for itm, mitem *@

  }

}
