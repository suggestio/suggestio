@(title: String, madOpt: Option[MAd], nodeOpt: Option[MNode], hPathAfter: Option[Html] = None,
  headAfter: Option[Html] = None)(content: Html)(implicit ctx: Context)

@* Подложка для страниц, работающих с унифицированными adn-узлами. *@
@import sys1.market._
@import ctx._

@hPathAfter1 = {
  /
  @defining( nodeOpt.flatMap(_.id).orElse( madOpt.map(_.producerId) ) ) { adnIdOpt =>
    @adnIdOpt.map { adnId =>
      <a href="@routes.SysMarket.showAdnNodeAds(new AdSearchImpl { override def producerIds = Seq(adnId) })">
    }
    Карточки
    @if(adnIdOpt) {
      </a>
    }
  }
  @madOpt.flatMap(_.id).map { madId =>
    / <a href="@routes.SysMarket.showAd(madId)">@madId</a>
  }
  @hPathAfter.getOrElse {
    / @title
  }
}

@views.html.sys1.market.adn.adnBase(
  title         = title + madOpt.flatMap(_.id).fold("")(" | " + _) + " | Карточки",
  hPathAfter    = Some(hPathAfter1),
  nodeOpt       = nodeOpt,
  headAfter     = headAfter
)(content)
