@(mad: MAd, producerOpt: Option[MNode], imgs: Map[String, im.MImgT])(implicit ctx: Context)

@import models.im.OutImgFmts.JPEG
@import ctx.messages
@import msc.OneAdRenderVariants._
@import im.MImg

@hPathAfter = { }

@sysAdBase(
  title       = "Карточка",
  madOpt      = Some(mad),
  hPathAfter  = Some(hPathAfter),
  nodeOpt     = producerOpt
) {

  <h1>Управление рекламной карточкой @mad.id</h1>

  <p>Продьюсер карточки:
    <a href="@routes.SysMarket.showAdnNode(mad.producerId)">
      @producerOpt.fold {
        ошибочен!
      } { prod =>
        Узел: @prod.meta.basic.name / @prod.meta.address.town
      }
    </a>
  </p>

  <p>Размеры карточки: ширина=@mad.blockMeta.width высота=@mad.blockMeta.height css-пикселей.</p>

  <p>
    <a href="@routes.MarketAd.editAd(mad.id.get)">Редактор карточки...</a>
  </p>

  @defining(mad.receivers.size) { rcvrsCount =>
    <p>Эта карточка сейчас @if(rcvrsCount > 0) {размещена на @rcvrsCount узлах} else {нигде не отображается}.
      <a href="@routes.SysMarket.analyzeAdRcvrs(mad.id.get)">Проанализировать...</a>
    </p>
  }

  <br/>

  <div>
    Отрендерить карточку в
    <ul>
      @defining( 1.0F ) { szMult =>
      @defining( blk.OneAdQsArgs(mad.id.get, szMult, mad.versionOpt, JPEG) ) { qsArgs =>
        <li>
           - <a href="@routes.MarketShowcase.onlyOneAd(qsArgs)">HTML x@szMult</a>
           или <a href="@routes.SysMarket.showOneAdForm(mad.id.get, ToHtml)">кастомно</a>.
        </li>
        <li>
          - <a href="@routes.MarketShowcase.onlyOneAdAsImage(qsArgs)">PNG x@szMult</a>
          или <a href="@routes.SysMarket.showOneAdForm(mad.id.get, ToImage)">кастомно</a>.
        </li>
      }
      }
    </ul>
  </div>

  <br/>

  <div>
    Картинки карточки:
    @if(imgs.isEmpty) {
      отсутствуют.
    } else {
      <ul>
        @imgs.iterator.map { case (k, mimg) =>
          <li>
            -
            <a href="@routes.SysImg.showOne(mimg)">
              <strong>@k</strong>
            </a>
            <a href="@routes.SysImg.makeForm(mimg, Some(mad.blockMeta))">
              [make]
            </a>
          </li>
        }
      </ul>
    }
  <div>

}
