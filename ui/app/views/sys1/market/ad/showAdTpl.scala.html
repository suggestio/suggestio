@(mad: MAd, producerOpt: Option[MAdnNode])(implicit ctx: Context)

@import models.im.OutImgFmts.JPEG
@import ctx.messages
@import msc.OneAdRenderVariants._
@import im.MImg

@sysAdBase(
  title   = "Карточка " + mad.id.get,
  madOpt  = Some(mad),
  nodeOpt = producerOpt
) {

  <h1>Управление рекламной карточкой @mad.id</h1>

  <p>Продьюсер карточки:
    <a href="@routes.SysMarket.showAdnNode(mad.producerId)">
      @if(producerOpt) {
        Узел: @producerOpt.get.meta.name / @producerOpt.get.meta.town.
      } else {
        ошибочен!
      }
    </a>
  </p>

  <p>Размеры карточки: ширина=@mad.blockMeta.width высота=@mad.blockMeta.height css-пикселей.</p>

  <p>
    <a href="@routes.MarketAd.editAd(mad.id.get)">Редактор карточки...</a>
  </p>

  @defining(mad.receivers.size) { rcvrsCount =>
    <p>Эта карточка сейчас @if(rcvrsCount > 0) {размещена на @rcvrsCount узлах} else {нигде не отображается}.
      <a href="@routes.SysMarket.analyzeAdRcvrs(mad.id.get)">Проанализировать...</a>
    </p>
  }

  <br/>

  <div>
    Отрендерить карточку в
    <ul>
      @defining( 1.0F ) { szMult =>
      @defining( blk.OneAdQsArgs(mad.id.get, szMult, mad.versionOpt, JPEG) ) { qsArgs =>
        <li>
           - <a href="@routes.MarketShowcase.onlyOneAd(qsArgs)">HTML x@szMult</a>
           или <a href="@routes.SysMarket.showOneAdForm(mad.id.get, ToHtml)">кастомно</a>.
        </li>
        <li>
          - <a href="@routes.MarketShowcase.onlyOneAdAsImage(qsArgs)">PNG x@szMult</a>
          или <a href="@routes.SysMarket.showOneAdForm(mad.id.get, ToImage)">кастомно</a>.
        </li>
      }
      }
    </ul>
  </div>

  <br/>

  <div>
    Картинки карточки:
    @mad.imgs.iterator.map { case (k, v) =>
      <a href="@routes.SysImg.showOne( MImg(v.filename) )">
        <strong>@k</strong>
      </a>,
    }
  <div>

}
