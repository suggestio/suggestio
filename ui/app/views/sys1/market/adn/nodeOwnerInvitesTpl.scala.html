@(adnNode: MAdnNode, imf: Form[_], eActs: Seq[usr.EmailActivation])(implicit ctx: Context)

@* Форма для создания инвайта на управление узлом рекламной сети. *@

@import helper._
@import sys1.market.adn._
@import util.FC.tdFc
@import ctx._
@import lk.lkBlock

@hPathAfter1 = {
  / Инвайт на управление
}

@adnBase(
  title = "Инвайт на управление ТЦ " + adnNode.meta.name,
  hPathAfter = Some(hPathAfter1),
  nodeOpt = Some(adnNode)
) {

  @lkBlock("Текущие владельцы ТЦ") {

    @if(adnNode.personIds.isEmpty) {
      У этого ТЦ нет пользователей, имеющих права доступа.
    } else {
      Текущие подтверждённые пользователи: <strong class="color-strong">@adnNode.personIds.mkString("  ")</strong>
    }

  }

  @lkBlock("Текущие отправленные инвайты") {

    @if(!eActs.isEmpty) {
      <ul>@eActs.map { eAct =>
        <li>@eAct.email</li>
      }</ul>
    } else {
      Инвайтов не найдено. Они или никогда не отсылались, либо были использованы получателями, либо уже истекли.
    }

  }

  @lkBlock("Новый инвайт") {

    Для отправки приглашения на управление ТЦ
    <a class="blue-link" href="@routes.SysMarket.showAdnNode(adnNode.id.get)">@adnNode.meta.name</a>
    введите email получателя прав в нижеуказанном поле.

    @* Форма инвайта прямо тут, т.к. не с кем её шарить. *@
    @form( CSRF(routes.SysMarket.nodeOwnerInviteFormSubmit(adnNode.id.get)) ) {
      <table class="input-w __size-L">
        @inputText(imf("email"))
      </table>
      <a class="siom-ac-btn __color-1 __size-M __ft-XM f-left js-submit-btn">Отправить инвайт</a>
    }

  }

  @lkBlock("Отладка") {

    Отобразить тело invite-письма:
    <a class="blue-link" href="@routes.SysMarket.showNodeOwnerEmailInvite(adnNode.id.get)">HTML</a>

  }

}
