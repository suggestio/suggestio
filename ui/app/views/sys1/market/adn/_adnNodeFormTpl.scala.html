@(af: Form[MAdnNode], call: Call, btnText: String, formAfter: Option[Html] = None)(implicit ctx: Context)

@* Форма для создания/редактирования узла рекламной сети.
   При верстке шаблона следует помнить, что mcompany.id может быть None. *@

@import helper._
@import ctx._
@import util.FC.tdFc

@form( CSRF(call) ) {

  <table class="input-w __size-L">
    <td class="input-w_left">
      <label class="input-w_prop-name">
        Тип узла ADN
      </label>
    </td>
    <td>
      @defining(af("adn.memberType")) { mtField =>
        <select name="@mtField.name">
          <option disabled>Тип узла</option>
          @AdNetMemberTypes.values.map { anmt =>
            <option value="@anmt.name" @if(mtField.value contains anmt.name) {selected}>@messages("amt.of.type." + anmt.name)</option>
          }
        </select>
      }
    </td>
  </table>

  <table class="input-w __size-L">
    <td class="input-w_left">
      <label class="input-w_prop-name">
        Отображаемый тип узла
      </label>
    </td>
    <td>
      @defining( af("adn.shownTypeIdOpt") ) { stiField =>
        <select name="@stiField.name">
          <option disabled>Тип узла</option>
          @AdnShownTypes.values.map { ast =>
            <option value="@ast" @if(stiField.value contains ast.toString) {selected}>@messages("amt.of.type." + ast)</option>
          }
        </select>
      }
    </td>
  </table>

  <table class="input-w __size-L">
    @checkbox(af("adn.isEnabled"), '_label -> "Включён?", '_class -> "sys-checkbox")
  </table>


  @* meta *@
  <table class="input-w __size-L">
    @inputText(af("meta.name"),    '_label -> "Название")
  </table>
  <table class="input-w __size-L">
    @inputText(af("meta.nameShort"),    '_label -> "Короткое название")
  </table>
  <table class="input-w __size-L">
      @textarea(af("meta.hiddenDescr"),  '_label -> "Скрытое описание", 'title -> "Доступно только администрации suggest.io.")
  </table>
  <table class="input-w __size-L">
    @inputText(af("meta.town"),    '_label -> "Город")
  </table>
  <table class="input-w __size-L">
    @inputText(af("meta.address"), 'placeholder -> "пр.Ленина, д.1",  '_label -> "Адрес в городе")
  </table>
  <table class="input-w __size-L">
    @inputText(af("meta.phone"),   'placeholder -> "+78121234567",    '_label -> "Номер телефона")
  </table>
  <table class="input-w __size-L">
    @inputText(af("meta.floor"),   'placeholder -> 1,                 '_label -> "Этаж")
  </table>
  <table class="input-w __size-L">
    @inputText(af("meta.section"), 'placeholder -> 101,               '_label -> "Номер секции")
  </table>
  <table class="input-w __size-L">
    @inputText(af("meta.siteUrl"), 'placeholder -> "http://",         '_label -> "Адрес сайта в интернете")
  </table>
  <table class="input-w __size-L">
    @inputText(af("meta.color"),   'placeholder -> "cceeff",          '_label -> "Цвет")
  </table>
  <table class="input-w __size-L">
    @inputText(af("personIds"),    '_label -> "id пользователей админов узла через запятую")
  </table>

  @* conf *@
  <table class="input-w __size-L">
    @inputText(af("conf.withBlocks"), 'placeholder -> "1, 2, 3",      '_label -> "Доп.id блоков")
  </table>


  @AdnRights.values.map { adnRight =>
    <table class="input-w __size-L">
      @checkbox(af(s"adn.rights.${adnRight.longName}"), '_label -> adnRight.longName, '_class -> "sys-checkbox")
    </table>
  }

  <table class="input-w __size-L">
    @inputText(af("adn.sls.in"),  '_label -> "Входящие уровни отображения и лимиты")
  </table>
  <table class="input-w __size-L">
    @inputText(af("adn.sls.out"), '_label -> "Исходящие уровни отображения и лимиты")
  </table>

  <table class="input-w __size-L">
    @checkbox(af("adn.testNode"), '_label -> "Тестовый узел?", '_class -> "sys-checkbox")
  </table>

  <table class="input-w __size-L">
    @checkbox(af("adn.isUser"), '_label -> "Пользовательский узел?", '_class -> "sys-checkbox")
  </table>

  <p>Формат: 'd = 1, m = 20, h = 5'.<br/>
  @AdShowLevels.values.map { sl =>
    @sl.name -- @messages("lk.sl." + sl.name),
  }</p>

  <table class="input-w __size-L">
    @inputText(af("adn.supId"), '_label -> "id узла-супервизора, если есть.")
  </table>

  <table class="input-w __size-L">
    @inputText(
      af("adn.advDelegate"),
      '_label -> "id узла-делегата рекламного размещения, если есть.",
      'title  -> "Входящие запросы рекламного размещения будут отправляться к указанному узлу, а не к текущему."
    )
  </table>

  <table>
    @inputText(
      af("conf.showcaseVoidFiller"),
      '_label -> "Заполнение пустот выдачи",
      'title -> "Идентификатор или текст для заполнения пустот в выдаче."
    )
  </table>

  <table class="input-w __size-L">
    @AdnSinks.ordered.map { sink =>
      @checkbox(
        af("adn.sink." + sink.longName),
        '_label -> messages("adn.sink." + sink.longName)
      )
    }
  </table>

  <table class="input-w __size-L">
    @checkbox(
      af("conf.showInScNodeList"),
      '_label -> "Отображать в списке узлов выдачи?"
    )
  </table>

  @formAfter

  <div class="btn-w __size-M">
    <input class="siom-ac-btn __color-1 __size-M __ft-XM f-right" value="@btnText" type="submit" />
  </div>

}
