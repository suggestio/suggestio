@(args: msc.ScRenderArgs)(implicit ctx: Context)

@* Панель поиска: текстового, фасетного по категориям, по рекламодателям (правая панель). *@

@import util.TplDataFormatUtil._
@import ctx.messages
@import msc._
@import views.html.sc.stuff._
@import io.suggest.sc.ScConstants.Search


@* Дедубликация кода рендера одной кнопки вкладки. *@
@__tabBtn(idSrc: Search.ITab, searchTabListOpt: Option[Boolean], inactive: Boolean, i18nName: String) = {
  @for(jsState <- args.jsStateOpt) {
    <a href="@args.syncUrl( jsState.copy(searchTabListOpt = searchTabListOpt) )">
  }
  <div class="sm-categories-screen_single-tab">
    <div class="sm-tab __rounded-left @if(inactive) {__inactive}" id="@idSrc.TAB_BTN_ID">
      @messages(i18nName).toUpperCase
    </div>
  </div>
  @if(args.jsStateOpt) {
    </a>
  }
}


<style type="text/css">
  @defining( colorRgb2Hsl(colorHex2rgb(args.bgColor)).toIndexedSeq ) { hslBgColor =>
    .sm-tab.__inactive {
      color: #@args.fgColor!important;
    }

    .sm-categories,
    .sm-shops {
      -webkit-box-shadow: inset 0px 10px 10px hsl( @{hslBgColor(0)}, @{hslBgColor(1)}%, @{hslBgColor(2)-10}% );
      box-shadow: inset 0px 5px 5px hsl( @{hslBgColor(0)}, @{hslBgColor(1)}%, @{hslBgColor(2)-6}% );
    }
  }

  @if(args.jsStateOpt.exists(_.isSearchScrOpened)) {
    .sm-categories-screen {
      display: block;
      height: 100%;
    }
  }

  .sm-categories-screen_tabs {
    background-color: @formatRgbHexColorCss( args.bgColor, Some(0.8F) );
  }

  .sm-tab {
    background: #@args.fgColor;
    border-color: #@args.fgColor;
    color: #@args.bgColor;
  }
</style>

<div class="sm-categories-screen __initial" id="smCategoriesScreen">

  <div class="sm-categories-screen_header">

    @ScHdrBtns.CatsIndexTransparent( args.hBtnArgs )

    <div class="sm-button sm-producer-header_btn __left-aligned abs" id="smCategoriesIndexButton">
    </div>

    @* Кнопка/ссылка закрытия этой поисковой панели. *@
    @args.jsStateOpt.map { jsState =>
      <a href="@args.syncUrl( jsState.toggleSearchScreen )">
    }
    @ScHdrBtns.CatsPanelClose( args.hBtnArgs )
    @if(args.jsStateOpt) {
      </a>
    }

  </div>

  @_searchTextTpl( args, "smSearch")

  @defining( args.jsStateOpt.exists(_.isSearchTabList) ) { isListTab =>
    @* Панель с кнопками табов. *@
    <div class="sm-categories-screen_tabs" id="smNavLayerTabs">
      <div class="sm-categories-screen_tabs-wrapper">
        @__tabBtn(Search.Cats, None, isListTab, "Map")
        @__tabBtn(Search.Nodes, Some(true), !isListTab, "List")
        <div class="clear"></div>
      </div>
    </div>

    @if(!args.syncRender || !isListTab) {
      @_catsListTpl( args )
    }
    @if(!args.syncRender || isListTab) {
      @_shopsListTpl( args )
    }

  }

</div>
