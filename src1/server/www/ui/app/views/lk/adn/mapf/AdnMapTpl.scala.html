@(args: madn.mapf.IAdnMapTplArgs)(implicit ctx: Context)

@* Шаблон страницы с формой размещения узла ADN на карте. *@

@import ctx.{messages, request}
@import views.js.stuff.jsRevRouterTpl
@import views.html.stuff.jsTpl2HtmlTpl
@import views.html.stuff.geo.maps._
@import lk.adv.widgets._
@import lk.lkwdgts.price._
@import lk.lkwdgts._formStateInputTpl
@import adv.tpl._
@import io.suggest.common.spa.SpaConst.STATE_CONT_ID
@import io.suggest.adn.mapf.AdnMapFormConstants.FORM_CONT_ID
@import io.suggest.adv.AdvConstants.Price
@import views.html.stuff._preLoaderLkTpl

@mapfBase(
  title         = messages(
    "x.on.advertisers.map",
    args.mnode.guessDisplayNameOrId.getOrElse( messages("Current.node") )
  ),
  mnode         = args.mnode,
  rightBarAfter = Some( _rightPriceContTpl(id = Some(Price.OUTER_CONT_ID))() )
) {

  @* Скрытый рендер как-то сериализованного состояния формы. *@
  @_formStateInputTpl( args.formB64 )

  <div id="@FORM_CONT_ID">
    @_preLoaderLkTpl()
  </div>


  @* Рендерим маркеры, необходимые для размещения ADN-узла на карте. *@
  @_mapMarkersContTpl() {

    @* Нужен pin-маркер для точки размещения. *@
    @_mapMarkersPinTpl()

  }



  @* JS-роутер. *@
  @jsTpl2HtmlTpl( withScriptTag = true )(
    jsRevRouterTpl( csrfAll = true )(
      routes.javascript.LkAdnMap.getPriceSubmit,
      routes.javascript.LkAdnMap.forNodeSubmit
    )
  )


}
